<p-dialog
  header="Informació de la zona d'estudi"
  [modal]="true"
  [(visible)]="visible"
  [style]="{ minHeight: '80dvh' }"
  [closable]="false"
>
  <form [formGroup]="studyZoneForm" class="flex flex-column mt-5">
    <span class="p-float-label">
      <input
        formControlName="name"
        class="w-full md:w-30rem"
        style="padding: 1rem"
        name="name"
        type="text"
        required
        pInputText
      />
      <label for="name">Nom</label>
    </span>
    <span class="p-float-label mt-5">
      <textarea
        formControlName="description"
        class="w-full md:w-30rem"
        style="padding: 1rem"
        name="description"
        required
        pInputTextarea
      ></textarea>
      <label for="description">Descripció</label>
    </span>
    <span class="p-float-label mt-5">
      <textarea
        formControlName="conclusion"
        class="w-full md:w-30rem"
        style="padding: 1rem"
        name="conclusion"
        required
        pInputTextarea
      ></textarea>
      <label for="conclusion">Conclusió</label>
    </span>
    <span class="p-float-label mt-5">
      <p-calendar
        formControlName="start_end_dates"
        dateFormat="yy-mm-dd"
        [selectionMode]="'range'"
        [touchUI]="true"
        required
      />
      <label for="conclusion">Data d'inici i fi</label>
    </span>
    <p-divider class="mt-3 mb-3" />
    <div class="flex flex-column gap-3">
      <span>Afegir fitxers</span>
      @if(documents.controls[0]){
      <div formArrayName="documents">
        <div
          *ngFor="let document of documents.controls; let i = index"
          [formGroupName]="i"
          class="flex flex-column gap-3"
        >
          <span class="p-float-label">
            <input
              formControlName="name"
              class="w-full md:w-30rem"
              style="padding: 1rem"
              name="name"
              type="text"
              required
              pInputText
            />
            <label for="name">Nom del document</label>
          </span>
          <p-fileUpload
            mode="basic"
            chooseLabel="Afegir fitxer"
            chooseIcon="pi pi-upload"
            name="demo[]"
            accept="image/*"
            maxFileSize="1000000"
            required
            (onSelect)="onUploadFile($event, i, true)"
          />
          <p-button
            type="button"
            label="Esborrar"
            (click)="removeDocument(i)"
          />
        </div>
      </div>
      }
      <p-button type="button" label="Afegir document" (click)="addDocument()" />
    </div>
    <p-divider class="mt-3 mb-3" />
    <div class="flex flex-column gap-3">
      <span>Afegir col·laborador</span>
      @if(collaborators.controls[0]){
      <div formArrayName="collaborators">
        <div
          *ngFor="let collaborator of collaborators.controls; let i = index"
          [formGroupName]="i"
          class="flex flex-column gap-3"
        >
          <span class="p-float-label">
            <input
              formControlName="collaborator_name"
              class="w-full md:w-30rem"
              style="padding: 1rem"
              name="collaborator_name"
              type="text"
              required
              pInputText
            />
            <label for="collaborator_name">Nom del col·laborador</label>
          </span>
          <span class="p-float-label">
            <input
              formControlName="contact_name"
              class="w-full md:w-30rem"
              style="padding: 1rem"
              name="contact_name"
              type="text"
              required
              pInputText
            />
            <label for="contact_name">Nom del contacte</label>
          </span>
          <span class="p-float-label">
            <input
              formControlName="contact_email"
              class="w-full md:w-30rem"
              style="padding: 1rem"
              name="contact_email"
              type="text"
              required
              pInputText
            />
            <label for="contact_email">Email del contacte</label>
          </span>
          <span class="p-float-label">
            <input
              formControlName="contact_phone"
              class="w-full md:w-30rem"
              style="padding: 1rem"
              name="contact_phone"
              type="text"
              required
              pInputText
            />
            <label for="contact_phone">Telèfon del contacte</label>
          </span>
          <p-fileUpload
            mode="basic"
            chooseLabel="Afegir logo"
            chooseIcon="pi pi-upload"
            name="demo[]"
            accept="image/*"
            maxFileSize="1000000"
            required
            (onSelect)="onUploadFile($event, i, false)"
          />
          <p-button
            type="button"
            label="Esborrar"
            (click)="removeCollaborator(i)"
          />
        </div>
      </div>
      }
      <p-button type="button" label="Afegir col·laborador" (click)="addCollaborator()" />
    </div>
    <div class="flex justify-content-center gap-2 w-full mt-5">
      <p-button
        label="Cancel·lar"
        severity="secondary"
        (onClick)="toggleDialog()"
      />
      <p-button label="Guardar zona d'estudi" (onClick)="toggleDialog()" />
    </div>
  </form>
</p-dialog>
